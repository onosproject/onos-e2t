#!/bin/sh

# Short help option
Help()
{
   echo "This script splits generated by ASN1C tool structure e2ap-v01.00.00.proto into 6 different files (with regard to their category)."
   echo "Example of usage:"
   echo "./csplit-protos.sh [-h] fileName"
   echo
   echo "[-h] --> Print this Help."
   echo
}

while getopts ":h" option; do
   case $option in
      h) # display Help
         Help
         exit;;
   esac
done

SPLITFILE=$1 #"e2ap-v01.00.00.proto"

csplit -sk ${SPLITFILE} '/\/\/\/\/\//' '{4}'

for f in "xx00" "xx01" "xx02" "xx03" "xx04" "xx05"
do
  FILENAME=$(cat $f | grep -oE '[A-Za-z0-9\-]*\.proto' | awk 'FNR <= 1')
  mv $f $FILENAME
done
